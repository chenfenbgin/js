<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // call apply的作用是什么 区别是什么： 改变this的指向， 参数的区别
      // 谈谈call apply，实际开发中用过call apply的场景

      // 场景： 1. js的继承， 原型链继承，构造函数继承 call实现
      //        2. 使用call判断js中复杂的数据类型
      console.log(Object.prototype.toString.call({})); // [object Object]
      console.log(Object.prototype.toString.call([])); // [object Array]

      // 3.将伪数组转换成数组
      function get() {
        console.log(arguments);
        // es6写法
        console.log([...arguments]);
        // es5写法
        console.log(Array.prototype.slice.call(arguments));
      }

      get(1, 2, 3);

      // 4.改变this指向
      var person = {
        getName: function () {
          // 5.6 这个this怎么指向person1
          return this.name;
        },
      };
      var person1 = {
        name: "荒天帝",
      };
      console.log(person.getName()); // undefined
      console.log(person.getName.call(person1)); // 荒天帝

      // 5.手写call第一个问题，怎么讲person.getName.myCall?
      // 参数接受的，就是改变this指向的参数
      Function.prototype.myCall = function(context) {
        // 5.1 思考：这里面的this是谁？ -> 谁调用，就是谁，笔记person.getName.myCall(person1),那就是person1
        console.log('this: ', context); // this:  {name: '荒天帝'}
        // 5.2 这里的this必须是一个function
        if(typeof this !== 'function'){
          throw new Error('error')
        }
        // 5.3 我们调用myCall时，必须传吗？如果不传，那this就是window
        context = context || window

        // 5.4 考虑参数，我们怎么拿到除了第一个参数之后的参数
        var args = [...arguments].slice(1)
        console.log('args: ', args); // args:  (4) [1, 2, 3, 4]

        // 5.5 我们最终是要执行getName, this就是getName
        // 5.7 要在person1上面假设有这个方法
        context.fn = this
        var result = context.fn(...args)
        return result

      }
      console.log(person.getName.myCall(person1, 1, 2, 3, 4)); // 荒天帝
    </script>
  </body>
</html>